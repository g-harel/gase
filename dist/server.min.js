!function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=1)}([function(t,e,n){"use strict";var r=function(){var t=function(t){return void 0!==t},e=function(t){return null===t},n=function(t){return Array.isArray(t)},r=function(t){return"function"==typeof t},i=function(t){return"string"==typeof t},o=function(t){return!!t&&t.constructor===Object},u=function(t){return!!(t&&t.tagName&&t.nodeName&&t.ownerDocument&&t.removeAttribute)},a=function(){if("undefined"!=typeof window)return!0},c=function(e){if(t(e))return JSON.parse(JSON.stringify(e))},s=function(t,e){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var o=function(t){return"\n>>> "+String(JSON.stringify(t,function(t,e){return"function"==typeof e?e.toString():e},2)).replace(/\n/g,"\n    ")};if(!t)throw r.length>0&&(e+=r.map(o).join("")),new Error("@okwolo."+e)};return{deepCopy:c,assert:s,isDefined:t,isNull:e,isArray:n,isFunction:r,isString:i,isObject:o,isNode:u,isBrowser:a,makeQueue:function(){var e=[],n=function(){var n=e[0];t(n)&&n()};return{add:function(t){s(r(t),"utils.makeQueue.add : added objects must be a function",t),e.push(t),1===e.length&&n()},done:function(){e.shift(),n()}}},bus:function(e){var n={},u={},a=function(e,o){s(i(e),"utils.bus : handler type is not a string",e),s(r(o),"utils.bus : handler is not a function",o),t(n[e])||(n[e]=[]),n[e].push(o)},c=function(r){s(o(r),"utils.bus : event is not an object",r);var a=r.name;if(t(a)){if(s(i(a),"utils.bus : event name is not a string",a),t(u[a]))return;u[a]=!0}Object.keys(r).forEach(function(i){if(t(n[i]))return e?void e.add(function(){n[i].forEach(function(t){return t(r[i])}),e.done()}):void n[i].forEach(function(t){return t(r[i])})})};return Object.assign(c,{on:a})}}};t.exports=r},function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var i=n(2),o=n(0)(),u=o.assert,a=o.isDefined,c=o.isFunction,s={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},d=function(t,e){u(c(t),"server.dom.draw : target is not a function",t);t(function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{text:""};if(a(e.text))return[e.text];var n=e.tagName,i=e.attributes,o=void 0===i?{}:i,u=e.children,c=void 0===u?[]:u,d=Object.keys(o).map(function(t){return"className"===t&&(t="class",o.class=o.className),t+'="'+o[t].toString()+'"'}).join(" ");return a(s[n])&&c.length<1?["<"+(n+" "+d).trim()+" />"]:["<"+(n+" "+d).trim()+">"].concat(r(c.reduce(function(e,n){return e.concat(t(n))},[]).map(function(t){return"  "+t})),["</"+n+">"])}(e).join("\n"))},f=function(){return{name:"okwolo-server-render",draw:d,update:d}};t.exports=i({modules:[n(3)],blobs:[n(4),f],options:{bundle:"server",browser:!1,modules:{state:!1,history:!1,dom:!0,router:!1}}})},function(t,e,n){"use strict";var r=n(0)(),i=r.isFunction,o=r.isDefined,u=r.assert,a=r.deepCopy,c=r.isBrowser,s=r.bus,d=function(t){var e=t.modules,n=t.blobs,r=t.options,d=function(t,d){r.browser&&(o(d)||(u(c(),"app : okwolo bundle must be run in a browser environment"),d=window));var f=s(),l=s(),b={exec:f,use:l};e.forEach(function(t){t({exec:f,use:l},d)}),n.forEach(function(t){l(t(d))});var m={},p=m;return f.on("state",function(t){p=t}),b.getState=function(){return u(p!==m,"getState : cannot get state before it has been set"),a(p)},r.modules.dom&&(b.update=function(){f({state:p})},o(t)&&l({target:t})),r.modules.state?(b.act=function(t,e){u("SET_STATE"===t||p!==m,"act : cannot act on state before it has been set"),f({act:{state:p,type:t,params:e}})},l({action:{type:"SET_STATE",target:[],handler:function(t,e){return e}}}),b.setState=function(t){if(i(t))return void b.act("SET_STATE",t(a(p)));b.act("SET_STATE",t)},r.modules.history&&(b.undo=function(){b.act("UNDO")},b.redo=function(){b.act("REDO")})):(u(!r.modules.history,"app : cannot use history blob without the state module",r),b.setState=function(t){if(i(t))return void f({state:t(a(p))});f({state:t})}),r.modules.router?(b.redirect=function(t,e){f({redirect:{path:t,params:e}})},b.show=function(t,e){f({show:{path:t,params:e}})},b.register=function(t,e){if(i(t))return void l({builder:t()});l({route:{path:t,callback:function(t){l({builder:e(t)})}}})}):b.register=function(t){l({builder:t()})},Object.assign(b.register,b)};return c()&&(d.bundle=r.bundle,o(window.okwolo)||(window.okwolo=d),window.okwolo[r.bundle]=d),d};t.exports=d},function(t,e,n){"use strict";var r=n(0)(),i=r.assert,o=r.isDefined,u=r.isFunction,a=function(t,e){var n=t.exec,r=t.use,a=void 0,c=void 0,s=void 0,d=void 0,f=void 0,l=void 0,b=void 0,m=void 0,p=void 0,h=function(t){var e=m(t);return d&&(e=d(e)),e=s(e),f&&(e=f(e)),e},v=!1,y=!1,g=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!v;if(!y){if(!(o(b)&&o(m)&&o(p)))return;y=!0}if(!t)return void(l=c(b,h(p),l));l=a(b,h(p)),v=!0};n.on("state",function(t){i(o(t),"dom.updateState : new state is not defined",t),p=t,g()}),r.on("target",function(t){b=t,g(!0)}),r.on("builder",function(t){i(u(t),"dom.replaceBuilder : builder is not a function",t),m=t,g()}),r.on("draw",function(t){i(u(t),"dom.replaceDraw : new draw is not a function",t),a=t,g(!0)}),r.on("update",function(t){i(u(t),"dom.replaceUpdate : new target updater is not a function",t),c=t,g()}),r.on("build",function(t){i(u(t),"dom.replaceBuild : new build is not a function",t),s=t,g()}),r.on("prebuild",function(t){i(u(t),"dom.replacePrebuild : new prebuild is not a function",t),d=t,g()}),r.on("postbuild",function(t){i(u(t),"dom.replacePostbuild : new postbuild is not a function",t),f=t,g()})};t.exports=a},function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var i=function(){function t(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var u,a=t[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&a.return&&a.return()}finally{if(i)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=n(0)(),u=o.assert,a=o.isDefined,c=o.isNull,s=o.isArray,d=o.isString,f=o.isNode,l=o.isObject,b=o.isFunction,m=o.makeQueue,p=function(t){var e=function e(n){if(a(n.text))return n.DOM=t.document.createTextNode(n.text),n;var r=t.document.createElement(n.tagName);return Object.keys(n.attributes).forEach(function(t){r[t]=n.attributes[t]}),Object.keys(n.children).forEach(function(t){n.children[t]=e(n.children[t]),r.appendChild(n.children[t].DOM)}),n.DOM=r,n},n=function(t,e){return Object.keys(Object.assign({},t,e)).filter(function(n){var r=t[n],i=e[n];return!(r!==Object(r)&&i!==Object(i)&&r===i)})},o=function t(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return n.map(function(e){return d(e)?e:s(e)?t.apply(void 0,r(e)):l(e)?t(Object.keys(e).map(function(t){return e[t]&&t})):void 0}).filter(Boolean).join(" ")};return{name:"@okwolo/dom",draw:function(n,r){return u(f(n),"dom.draw : target is not a DOM node",n),a(r)||(r={text:""}),r=e(r),t.requestAnimationFrame(function(){n.innerHTML="",n.appendChild(r.DOM)}),r},update:function(r,i,o){u(f(r),"dom.update : target is not a DOM node",r);var c=m();t.requestAnimationFrame(function(){c.add(function(){s(o,i,{DOM:r,children:[o]},0),c.done()})});var s=function t(r,i,o,u){if(a(r)||a(i)){if(!a(r))return o.children[u]=e(i),void o.DOM.appendChild(o.children[u].DOM);if(!a(i))return o.DOM.removeChild(r.DOM),void c.add(function(){delete o.children[u],c.done()});if(r.tagName!==i.tagName){var s=r.DOM,d=e(i);return o.DOM.replaceChild(d.DOM,s),void(a(d.text)?(o.children[u].DOM=d.DOM,o.children[u].text=d.text,delete o.children[u].tagName,delete o.children[u].attributes,delete o.children[u].children):(o.children[u].DOM=d.DOM,delete o.children[u].text,o.children[u].tagName=d.tagName,o.children[u].attributes=d.attributes,o.children[u].children=d.children))}if(3===r.DOM.nodeType)r.text!==i.text&&(r.DOM.nodeValue=i.text,r.text=i.text);else{var f=n(r.attributes,i.attributes);0!==f.length&&f.forEach(function(t){r.attributes[t]=i.attributes[t],r.DOM[t]=i.attributes[t]})}var l=Object.keys(r.children||{}).concat(Object.keys(i.children||{})),b={};l.forEach(function(e){void 0===b[e]&&(b[e]=!0,t(r.children[e],i.children[e],r,e))})}};return o},build:function t(e){if(c(e))return{text:""};if(d(e))return{text:e};if(u(s(e),"dom.build : vdom object is not an array or string",e),b(e[0])){var n=e[1]||{};u(l(n),"dom.build : component's props is not an object",e,n);var r=e[2]||[];return u(s(r),"dom.build : component's children is not an array",e,r),t(e[0](Object.assign({},n,{children:r})))}var f=i(e,3),m=f[0],p=f[1],h=f[2];u(d(m),"dom.build : tag property is not a string",e,m);var v=/^ *(\w+) *(?:#([-\w\d]+))? *((?:\.[-\w\d]+)*)? *(?:\|\s*([^\s]{1}[^]*?))? *$/.exec(m);u(s(v),"dom.build : tag property cannot be parsed",m);var y=i(v,5),g=y[1],w=y[2],O=y[3],x=y[4];return null==p&&(p={}),u(l(p),"dom.build : attributes is not an object",e,p),a(w)&&!a(p.id)&&(p.id=w.trim()),(a(p.className)||a(O))&&(p.className=o(p.className,O).replace(/\./g," ").replace(/  +/g," ").trim()),a(x)&&(a(p.style)?(p.style+=";"+x,p.style=p.style.replace(/;;/g,";")):p.style=x),a(h)?u(s(h),"dom.build : children of vdom object is not an array",e,h):h=[],{tagName:g,attributes:p,children:h.map(t)}}}};t.exports=p}]);