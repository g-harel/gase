!function(n){function t(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return n[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var e={};t.m=n,t.c=e,t.d=function(n,e,o){t.o(n,e)||Object.defineProperty(n,e,{configurable:!1,enumerable:!0,get:o})},t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,"a",e),e},t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},t.p="",t(t.s=1)}([function(n,t,e){"use strict";var o=function(){var n=function(n){return void 0!==n},t=function(n){return null===n},e=function(n){return Array.isArray(n)},o=function(n){return"function"==typeof n},r=function(n){return"string"==typeof n},i=function(n){return!!n&&n.constructor===Object},u=function(n){return!!(n&&n.tagName&&n.nodeName&&n.ownerDocument&&n.removeAttribute)},a=function(){if("undefined"!=typeof window)return!0},c=function(t){if(n(t))return JSON.parse(JSON.stringify(t))},s=function(n,t){for(var e=arguments.length,o=Array(e>2?e-2:0),r=2;r<e;r++)o[r-2]=arguments[r];var i=function(n){return"\n>>> "+String(JSON.stringify(n,function(n,t){return"function"==typeof t?t.toString():t},2)).replace(/\n/g,"\n    ")};if(!n)throw o.length>0&&(t+=o.map(i).join("")),new Error("@okwolo."+t)};return{deepCopy:c,assert:s,isDefined:n,isNull:t,isArray:e,isFunction:o,isString:r,isObject:i,isNode:u,isBrowser:a,makeQueue:function(){var t=[],e=function(){var e=t[0];n(e)&&e()};return{add:function(n){s(o(n),"utils.makeQueue.add : added objects must be a function",n),t.push(n),1===t.length&&e()},done:function(){t.shift(),e()}}},bus:function(t){var e={},u={},a=function(t,i){s(r(t),"utils.bus : handler type is not a string",t),s(o(i),"utils.bus : handler is not a function",i),n(e[t])||(e[t]=[]),e[t].push(i)},c=function(o){s(i(o),"utils.bus : event is not an object",o);var a=o.name;if(n(a)){if(s(r(a),"utils.bus : event name is not a string",a),n(u[a]))return;u[a]=!0}Object.keys(o).forEach(function(r){if(n(e[r]))return t?void t.add(function(){e[r].forEach(function(n){return n(o[r])}),t.done()}):void e[r].forEach(function(n){return n(o[r])})})};return Object.assign(c,{on:a})}}};n.exports=o},function(n,t,e){"use strict";function o(n){if(Array.isArray(n)){for(var t=0,e=Array(n.length);t<n.length;t++)e[t]=n[t];return e}return Array.from(n)}var r=e(2),i=e(0)(),u=i.assert,a=i.isDefined,c=i.isFunction,s={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},f=function(n,t){u(c(n),"server.dom.draw : target is not a function",n);n(function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{text:""};if(a(t.text))return[t.text];var e=t.tagName,r=t.attributes,i=void 0===r?{}:r,u=t.children,c=void 0===u?[]:u,f=Object.keys(i).map(function(n){return n+'="'+i[n].toString()+'"'}).join(" ");return a(s[e])?["<"+(e+" "+f).trim()+" />"]:["<"+(e+" "+f).trim()+">"].concat(o(c.reduce(function(t,e){return t.concat(n(e))},[]).map(function(n){return"  "+n})),["</"+e+">"])}(t).join("\n"))},d={name:"okwolo-server-render",draw:f,update:f};n.exports=r({modules:[e(3)],blobs:[d],options:{bundle:"server",browser:!1,modules:{state:!1,history:!1,dom:!0,router:!1}}})},function(n,t,e){"use strict";var o=e(0)(),r=o.isFunction,i=o.isDefined,u=o.assert,a=o.deepCopy,c=o.isBrowser,s=o.bus,f=function(n){var t=n.modules,e=n.blobs,o=n.options,f=function(n,f){o.browser&&(i(f)||(u(c(),"app : this version of okwolo must be run in a browser environment"),f=window));var d=s(),l=s(),p={exec:d,use:l};t.forEach(function(n){n({exec:d,use:l},f)}),e.forEach(function(n){l(n(f))});var b={},m=b;return d.on("state",function(n){m=n}),p.getState=function(){return u(m!==b,"getState : cannot get state before it has been set"),a(m)},o.modules.dom&&(p.update=function(){d({state:m})},i(n)&&l({target:n})),o.modules.state?(p.act=function(n,t){u("SET_STATE"===n||m!==b,"act : cannot act on state before it has been set"),d({act:{state:m,type:n,params:t}})},l({action:{type:"SET_STATE",target:[],handler:function(n,t){return t}}}),p.setState=function(n){if(r(n))return void p.act("SET_STATE",n(a(m)));p.act("SET_STATE",n)},o.modules.history&&(p.undo=function(){p.act("UNDO")},p.redo=function(){p.act("REDO")})):(u(!o.modules.history,"app : cannot use history blob without the state module",o),p.setState=function(n){if(r(n))return void d({state:n(a(m))});d({state:n})}),o.modules.router?(p.redirect=function(n,t){d({redirect:{path:n,params:t}})},p.show=function(n,t){d({show:{path:n,params:t}})},p.register=function(n,t){if(r(n))return void l({builder:n()});l({route:{path:n,callback:function(n){l({builder:t(n)})}}})}):p.register=function(n){u(r(n),"register : builder is not a function",n),l({builder:path()})},Object.assign(p.register,p)};return c()&&(f.bundle=o.bundle,i(window.okwolo)||(window.okwolo=f),window.okwolo[o.bundle]=f),f};n.exports=f},function(n,t,e){"use strict";var o=e(0)(),r=o.assert,i=o.isDefined,u=o.isFunction,a=function(n,t){var e=n.exec,o=n.use,a=void 0,c=void 0,s=void 0,f=void 0,d=void 0,l=void 0,p=void 0,b=void 0,m=void 0,v=function(n){var t=b(n);return f&&(t=f(t)),t=s(t),d&&(t=d(t)),t},w=!1,g=function(){w=!0,l=a(p,l)},h=function(n){i(p)&&i(b)&&i(m)&&n()};e.on("state",function(n){r(i(n),"dom.updateState : new state is not defined",n),m=n,h(function(){w||g(),l=c(p,v(m),l)})}),o.on("target",function(n){p=n,h(g)}),o.on("builder",function(n){r(u(n),"dom.replaceBuilder : builder is not a function",n),b=n,h(function(){w||g(),l=c(p,v(m),l)})}),o.on("draw",function(n){r(u(n),"dom.replaceDraw : new draw is not a function",n),a=n,h(g)}),o.on("update",function(n){r(u(n),"dom.replaceUpdate : new target updater is not a function",n),c=n}),o.on("build",function(n){r(u(n),"dom.replaceBuild : new build is not a function",n),s=n,h(function(){return c(p,v(m),l)})}),o.on("prebuild",function(n){r(u(n),"dom.replacePrebuild : new prebuild is not a function",n),f=n,h(function(){return c(p,v(m),l)})}),o.on("postbuild",function(n){r(u(n),"dom.replacePostbuild : new postbuild is not a function",n),d=n,h(function(){return c(p,v(m),l)})})};n.exports=a}]);